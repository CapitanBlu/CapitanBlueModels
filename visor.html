<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Viewer | CapitanBlue</title>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #050505; color: white; font-family: sans-serif; overflow: hidden; }
        
        model-viewer { width: 100%; height: 100vh; background: #0a0a0a; }

        .ui { position: absolute; top: 20px; left: 20px; z-index: 100; }
        .back-btn { text-decoration: none; color: white; background: rgba(255,255,255,0.1); padding: 10px 20px; border-radius: 8px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); transition: 0.3s; }
        .back-btn:hover { background: #0064e0; }

        .controls {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 15px; background: rgba(0,0,0,0.8); padding: 15px 30px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.1);
        }

        button { background: transparent; border: 1px solid #444; color: white; padding: 8px 15px; border-radius: 20px; cursor: pointer; font-size: 12px; transition: 0.3s; }
        button:hover { background: #0064e0; border-color: #0064e0; }
    </style>
</head>
<body>

    <div class="ui">
        <a href="index.html" class="back-btn">← Volver</a>
        <h2 id="model-title" style="margin-top: 25px; font-weight: 300;">Cargando...</h2>
    </div>

    <model-viewer 
        id="mainViewer" 
        src="" 
        camera-controls 
        auto-rotate 
        shadow-intensity="1" 
        exposure="1" 
        environment-image="neutral">
        
        <div class="controls">
            <button onclick="toggleRotate()">Rotar On/Off</button>
            <button onclick="resetCam()">Reset Cámara</button>
            <button onclick="toggleWireframe()">Ver Malla</button>
        </div>
    </model-viewer>

    <script>
        const viewer = document.querySelector("#mainViewer");
        const title = document.querySelector("#model-title");

        // Lógica para capturar el modelo de la URL
        const params = new URLSearchParams(window.location.search);
        const modelFile = params.get('model');

        if(modelFile) {
            viewer.src = `modelos/${modelFile}`;
            title.innerText = modelFile.replace('.glb', '').toUpperCase();
        }

        function toggleRotate() { viewer.autoRotate = !viewer.autoRotate; }
        function resetCam() { viewer.cameraOrbit = "0deg 75deg 105%"; }
        
        function toggleWireframe() {
            // Simulación de wireframe (Para wireframe real se requiere editar materiales en Three.js)
            alert("Accediendo a la estructura de polígonos del archivo .glb...");
        }
    </script>
</body>
</html>
